<!DOCTYPE HTML>
<html xmlns:th="http://www.w3.org/1999/xhtml">
    <head>
        <title>Lista ordini</title>
        <!-- File CSS -->
        <link rel="stylesheet" type="text/css" href="static/listOrder.css">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>

    <body class="corpo">
    {{ session['role'] }}
        <h1>Ordini</h1>
        <!-- Titolo tabella -->
        <div id="movimento">
            <table id="titoloTab">
                <thead>
                    <tr>
                        <th>Numero Ordine</th>
                        <th>Importo ordine</th>
                        <th>Acconto dell'ordine</th>
                        <th>Data dell'ordine</th>
                        {%if session['role'] == 'DIRETTORE' or session['role'] == 'AGENTE'%}
                            <th>Codice dell'utente</th>
                        {%endif%}
                        {%if session['role'] == 'DIRETTORE' or session['role'] == 'CLIENTE'%}
                            <th>Codice dell'agente</th>
                        {%endif%}
                        <th>Descrizione dell'ordine</th>
                        {%if session['role'] == 'DIRETTORE' or session['role'] == 'AGENTE'%}
                            <th></th>
                            <th></th>
                        {%endif%}
                    </tr>
                </thead>
            </table>
        </div>

        <!-- Dati tabella -->
        <table id="datiTab">
            <tbody>
                {% for row in orders %}
                    <tr>
                        <td>{{row[0]}}</td>
                        <td>{{row[1]}}</td>
                        <td>{{row[2]}}</td>
                        <td>{{row[3]}}</td>
                        {%if session['role'] == 'DIRETTORE' or session['role'] == 'AGENTE'%}
                            <td>
                                {% for info in costumerInfo %}
                                    {%if info[0] == row[4]%}
                                        <details><summary> {{info[1]}} </summary>
                                            <div>
                                                Codice cliente: {{info[0]}}<br>
                                                Città: {{info[2]}}<br>
                                                Area di Lavoro: {{info[3]}}<br>
                                                Città: {{info[4]}}<br>
                                                Grado: {{info[5]}}<br>
                                                Opening amt: {{info[6]}}<br>
                                                Soldi ricevuti: {{info[7]}}<br>
                                                Pagamenti: {{info[8]}}<br>
                                                Out standing: {{info[9]}}<br>
                                                N°Telefono: {{info[10]}}<br>
                                                Agente associato: {{info[11]}}<br>
                                            </div>
                                        </details>
                                    {%endif%}
                                {%endfor%}
                            </td>
                        {%endif%}
                        {%if session['role'] == 'DIRETTORE' or session['role'] == 'CLIENTE'%}
                            <td>
                                <details><summary> {{row[5]}} </summary>
                                    {% for info in agentInfo %}
                                        {%if info[0] == row[5]%}
                                            <div>
                                                Nome: {{info[1]}}<br>
                                                Area di Lavoro: {{info[2]}}<br>
                                                Commissione: {{info[3]}}<br>
                                                N°Telefono: {{info[4]}}<br>
                                                Città: {{info[5]}}<br>
                                            </div>
                                        {%endif%}
                                    {%endfor%}
                                </details>
                            </td>
                        {%endif%}
                        <td>{{row[6]}}</td>
                        {%if session['role'] == 'DIRETTORE' or session['role'] == 'AGENTE'%}
                            <td><a class="modLink" href="/changeOrder?ordNum={{row[0]}}"> Modifica </a></td>
                            <td><a class="modLink" href="/deleteOrder?ordNum={{row[0]}}"> Elimina </a></td>
                        {%endif%}
                    </tr>
                {% endfor %}
            </tbody>
        </table>

        <!-- Bottone inserimeto ordine -->
        {%if session['role'] == 'DIRETTORE' or session['role'] == 'AGENTE'%}
            <form action="insertOrder" method="POST">
                <br>

                <input class="modLink" type="submit" value="Inserisci ordine"/>
            </form>
        {%endif%}

        <!-- Bottone Logout -->
        <form action="logout">
            <br>
            <input id="modLogout" type="submit" value="Esci"/>
        </form>
    </body>
</html>